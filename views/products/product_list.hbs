<div class="content-wrapper">
    {{!-- welcome --}}
    <div class="row">
        <div class="col-md-12 grid-margin">
            <div class="row">
                <div class="col-12 col-xl-8 mb-4 mb-xl-0">
                    <div class="row ml-2">
                        {{#if isNecessities}}
                        <button type="button" class="btn btn-2side left-side active-btn">Necessities</button>
                        <button type="button" class="btn btn-2side right-side non-active-btn"
                            onclick="location.href='/packs';">Package</button>
                        {{else if isPackage}}
                        <button type="button" class="btn btn-2side left-side non-active-btn"
                            onclick="location.href='/products';">Necessities</button>
                        <button type="button" class="btn btn-2side right-side active-btn">Package</button>
                        {{else}}
                        {{/if}}
                    </div>
                </div>
                <div class="col-12 col-xl-4">
                    <div class="justify-content-end d-flex">
                        <div class="input-group">
                            <input type="text" class="form-control" id="content-search-input" placeholder="Search"
                                aria-label="search" aria-describedby="search">
                            <div class="input-group-prepend hover-cursor" id="content-search-icon">
                                <span class="input-group-text" id="userlist-search">
                                    <i class="icon-search"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 grid-margin">
            <div class="row">
                <div class="col-12 col-xl-8 mb-4 mb-xl-0">
                    <div class="row">
                        <h3 class="font-weight-bold mr-5"
                            style="margin-top: auto; margin-bottom: auto; margin-left: 1.5rem">Necessities</h3>
                        <button class="btn btn-primary mr-2" onclick="location.href='/products/new';"> Add new</button>
                    </div>
                </div>
                <div class="col-12 col-xl-4">
                    <div class="justify-content-end d-flex">
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary">Filter</button>
                            <button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split"
                                id="dropdownMenuSplitButton1" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                <span class="sr-only">Toggle Dropdown</span>
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuSplitButton1">
                                <a class="dropdown-item"
                                    href="/products?order-by=name-ascending">A-Z</a>
                                <a class="dropdown-item"
                                    href="/products?order-by=name-descending">Z-A</a>
                                <a class="dropdown-item"
                                    href="/products?order-by=price-ascending">Price ascending</a>
                                <a class="dropdown-item"
                                    href="/products?order-by=price-descending">Price descending</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12 grid-margin stretch-card">
            <div class="card">
                <div class="card-body">
                    <p class="card-title mb-0">Product List</p>
                    <div class="table-responsive table-hover" style="height: 430px; overflow: auto;">
                        <table class="table table-borderless">
                            <thead style="border-bottom: 2px solid black">
                                <tr>
                                    <th>Photo</th>
                                    <th>Name</th>
                                    <th>Price (VND)</th>
                                    <th>Unit</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{#each productList}}
                                <tr>
                                    <td class="py-1 hover-cursor" onclick="location.href='/products/{{this.id}}/view';">
                                        <img src="{{this.url}}"  style="width:100px; height:100px" alt="image"/>
                                    </td>
                                    <td class="hover-cursor" onclick="location.href='/products/{{this.id}}/view';">
                                        {{this.name}}</td>
                                    <td class="hover-cursor" onclick="location.href='/products/{{this.id}}/view';">
                                        {{this.price}}</td>
                                    <td class="hover-cursor" onclick="location.href='/products/{{this.id}}/view';">
                                        {{this.unit}}</td>
                                    <td class="font-weight-medium">
                                        <div class="row">
                                            <div class="badge badge-primary hover-cursor" onclick="location.href='/products/{{this.id}}/edit';"><i class="mdi mdi-pencil mx-2"></i></div>
                                            <div class="badge badge-danger hover-cursor" id="{{this.id}}" onclick="showModalDel(this.id)"><i class="icon-trash mx-2"></i></div>
                                        </div>
                                    </td>
                                </tr>
                                <div class="modal fade" id="modal-del-pack-{{this.id}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Confirmation</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body" id="modal-pack-name">
                                                {{#if this.name}}
                                                    Are you sure to delete "{{this.name}}" ?
                                                {{/if}}
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                                                {{!-- <button type="button" class="btn btn-danger" id="btn-del-pack" data-dismiss="modal" onclick="onclickDelete(id)">Delete</button> --}}
                                                <button type="button" class="btn btn-danger" id="{{this.id}}" data-dismiss="modal" onclick="onClickDelete(this.id)">Delete</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {{/each}}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{{#section "js"}}
<!-- Custom js for this page-->
<script type="text/javascript" src="js/dashboard.js"></script>
<script type="text/javascript" src="js/Chart.roundedBarCharts.js"></script>

<script>
    function showModalDel(id) {
        $(`#modal-del-pack-${id}`).modal('show');
    }

    async function onClickDelete(id) {
        console.log(id);
        await $.ajax({
            url: `/products/${id}`,
            type: 'DELETE',
            success: async function (response, status) {
                const res = await response;
                console.log(res);
                window.location.href = '/products';
            }
        });
    }
</script>

<!-- End custom js for this page-->
{{/section}}